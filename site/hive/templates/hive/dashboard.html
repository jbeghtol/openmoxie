{% extends 'base.html' %}
{% block content %}
<div class="p-3">
<h2>Devices</h2>
<a class="btn btn-primary btn-sm" role="button" href="{% url 'hive:endpoint_qr' %}">Migration QR Code</a>
<a class="btn btn-secondary btn-sm" href="{% url 'hive:setup' %}">Setup</a>
<a class="btn btn-secondary btn-sm" href="{% url 'admin:index' %}">Admin</a>
<table class="table table-striped">
  <tr><th class="w-25">Status</th><th>Moxie Devices</th><th>Schedule</th></tr>
  {% for device in recent_devices %}
  <tr><td>
    {% if device.device_id in live %}
    <span class="badge text-bg-success">Online</span> {{device.last_connect|timesince}}
    {% else %}
    <span class="badge text-bg-secondary">Offline</span> {{device.last_disconnect|timesince}}
    {% endif %}
  </td><td><a href="{% url 'hive:moxie' device.pk %}">{{device}}</a></td><td>{{device.schedule}}</td></tr>
  {% endfor %}
</table>
<br>
<h2>Schedules</h2>
<table class="table table-striped">
  <tr><th>Name</th></tr>
  {% for s in schedules %}
  <tr><td>{{s.name}}</td></tr>
  {% endfor %}
</table>
<br>
<h2>Conversations</h2><a class="btn btn-primary btn-sm" role="button" href="{% url 'hive:reload_database' %}">Refresh from DB</a>
<table class="table table-striped">
  <tr><th>Module ID</th><th>Content ID</th><th></th></tr>
  {% for s in conversations %}
  <tr><td>{{s.module_id}}</td><td>{{s.content_id}}</td><td><a href="{% url 'hive:interact' s.pk %}">Interact</a></td></tr>
  {% endfor %}
</table>
</div>
{% endblock %}